{"ast":null,"code":"var _jsxFileName = \"/home/mspl/Desktop/peerformance_frontend/src/pages/EmailAuth.jsx\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport toast from 'react-hot-toast';\nimport { useLocation, useHistory } from 'react-router-dom';\nimport Notification from '../components/Notification';\nimport { checkAuthToken, refreshAuthToken } from '../Signup/fetches';\nimport PeerformanceLogo from \"../assets/peerformance_logo.svg\";\nimport { PAGES } from '../constants/en';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst EmailAuth = () => {\n  _s();\n\n  const [isAuth, setIsAuth] = useState(undefined);\n  const [error, setError] = useState(null);\n  const [supervisorEmail, setSupervisorEmail] = useState(null);\n  const [submiterEmail, setSubmiterEmail] = useState(null);\n  const {\n    search\n  } = useLocation();\n  const history = useHistory();\n  useEffect(() => {\n    const params = new URLSearchParams(search);\n    const token = params.get('token');\n\n    if (token) {\n      const verifyAuthToken = async () => {\n        try {\n          var _response$data, _response$data2, _response$data3;\n\n          const response = await checkAuthToken(token);\n\n          if (response && (_response$data = response.data) !== null && _response$data !== void 0 && _response$data.tokenValid) {\n            setIsAuth(true);\n          } else {\n            setIsAuth(false);\n            setError(response.data.error);\n          }\n\n          const supervisorEmail = response === null || response === void 0 ? void 0 : (_response$data2 = response.data) === null || _response$data2 === void 0 ? void 0 : _response$data2.supervisorEmail;\n          const userEmail = response === null || response === void 0 ? void 0 : (_response$data3 = response.data) === null || _response$data3 === void 0 ? void 0 : _response$data3.userEmail;\n          if (supervisorEmail) setSupervisorEmail(supervisorEmail);\n          if (userEmail) setSubmiterEmail(userEmail);\n        } catch (error) {\n          console.error(PAGES.EMAIL_AUTH.MESSAGES.TOKEN_FAILED, error);\n          setIsAuth(false);\n        }\n      };\n\n      verifyAuthToken();\n    }\n  }, []);\n\n  const handleRefreshAuthToken = async () => {\n    await refreshAuthToken(submiterEmail, supervisorEmail);\n    setError(null);\n    toast.success(PAGES.EMAIL_AUTH.MESSAGES.ACTIVATION_LINK_SENT, {\n      duration: 6000,\n      position: 'top-center'\n    });\n    history.push('/');\n  };\n\n  return isAuth !== undefined ? isAuth ? /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"row email-auth\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"col-md-5 col-sm-12 mx-auto\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        className: \"w-50 mx-auto d-block mt-5\",\n        src: PeerformanceLogo,\n        alt: \"Peerformance Logo\",\n        width: \"263\",\n        height: \"121\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"alert alert-success notification-message mt-4\",\n        role: \"alert\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"m-0\",\n          children: PAGES.EMAIL_AUTH.MESSAGES.SUCCESSFULLY_AUTHORIZED\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 4\n  }, this) : error ? /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"row email-auth\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"col-md-5 col-sm-12 mx-auto\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        className: \"w-50 mx-auto d-block mt-5\",\n        src: PeerformanceLogo,\n        alt: \"Peerformance Logo\",\n        width: \"263\",\n        height: \"121\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"alert alert-warning notification-message mt-4\",\n        role: \"alert\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [error, \".\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 8\n          }, this), \"If you would like to renew the authorization process,\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 8\n          }, this), \"click on this link\", ' ', /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-decoration-underline text-primary c-pointer\",\n            onClick: handleRefreshAuthToken,\n            children: \"link\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 8\n          }, this), ' ', \"and check your e-mail address to complete the authorization process.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 4\n  }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"row email-auth\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"col-md-5 col-sm-12 mx-auto\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        className: \"w-50 mx-auto d-block mt-5\",\n        src: PeerformanceLogo,\n        alt: \"Peerformance Logo\",\n        width: \"263\",\n        height: \"121\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Notification, {\n        type: \"danger\",\n        message: \"Invalid token\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 6\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 5\n  }, this) : null;\n};\n\n_s(EmailAuth, \"RKWFPjUa4miOESfKlp3/uK5U9PE=\", false, function () {\n  return [useLocation, useHistory];\n});\n\n_c = EmailAuth;\nexport default EmailAuth;\n\nvar _c;\n\n$RefreshReg$(_c, \"EmailAuth\");","map":{"version":3,"sources":["/home/mspl/Desktop/peerformance_frontend/src/pages/EmailAuth.jsx"],"names":["useState","useEffect","toast","useLocation","useHistory","Notification","checkAuthToken","refreshAuthToken","PAGES","EmailAuth","isAuth","setIsAuth","undefined","error","setError","supervisorEmail","setSupervisorEmail","submiterEmail","setSubmiterEmail","search","history","params","URLSearchParams","token","get","verifyAuthToken","response","data","tokenValid","userEmail","console","EMAIL_AUTH","MESSAGES","TOKEN_FAILED","handleRefreshAuthToken","success","ACTIVATION_LINK_SENT","duration","position","push","PeerformanceLogo","SUCCESSFULLY_AUTHORIZED"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\nimport toast from 'react-hot-toast';\nimport { useLocation, useHistory } from 'react-router-dom';\nimport Notification from '../components/Notification';\nimport { checkAuthToken, refreshAuthToken } from '../Signup/fetches';\nimport PeerformanceLogo from '../assets/peerformance_logo.svg';\nimport { PAGES } from '../constants/en';\n\nconst EmailAuth = () => {\n\tconst [isAuth, setIsAuth] = useState(undefined);\n\tconst [error, setError] = useState(null);\n\tconst [supervisorEmail, setSupervisorEmail] = useState(null);\n\tconst [submiterEmail, setSubmiterEmail] = useState(null);\n\tconst { search } = useLocation();\n\tconst history = useHistory();\n\n\tuseEffect(() => {\n\t\tconst params = new URLSearchParams(search);\n\t\tconst token = params.get('token');\n\n\t\tif (token) {\n\t\t\tconst verifyAuthToken = async () => {\n\t\t\t\ttry {\n\t\t\t\t\tconst response = await checkAuthToken(token);\n\n\t\t\t\t\tif (response && response.data?.tokenValid) {\n\t\t\t\t\t\tsetIsAuth(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetIsAuth(false);\n\t\t\t\t\t\tsetError(response.data.error);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst supervisorEmail = response?.data?.supervisorEmail;\n\t\t\t\t\tconst userEmail = response?.data?.userEmail;\n\t\t\t\t\tif (supervisorEmail) setSupervisorEmail(supervisorEmail);\n\t\t\t\t\tif (userEmail) setSubmiterEmail(userEmail);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error(PAGES.EMAIL_AUTH.MESSAGES.TOKEN_FAILED, error);\n\t\t\t\t\tsetIsAuth(false);\n\t\t\t\t}\n\t\t\t};\n\t\t\tverifyAuthToken();\n\t\t}\n\t}, []);\n\n\tconst handleRefreshAuthToken = async () => {\n\t\tawait refreshAuthToken(submiterEmail, supervisorEmail);\n\t\tsetError(null);\n\t\ttoast.success(PAGES.EMAIL_AUTH.MESSAGES.ACTIVATION_LINK_SENT, {\n\t\t\tduration: 6000,\n\t\t\tposition: 'top-center',\n\t\t});\n\t\thistory.push('/');\n\t};\n\n\treturn isAuth !== undefined ? (\n\t\tisAuth ? (\n\t\t\t<div className='row email-auth'>\n\t\t\t\t<div className='col-md-5 col-sm-12 mx-auto'>\n\t\t\t\t\t<img\n\t\t\t\t\t\tclassName='w-50 mx-auto d-block mt-5'\n\t\t\t\t\t\tsrc={PeerformanceLogo}\n\t\t\t\t\t\talt='Peerformance Logo'\n\t\t\t\t\t\twidth='263'\n\t\t\t\t\t\theight='121'\n\t\t\t\t\t/>\n\t\t\t\t\t<br/>\n\t\t\t\t\t<div className='alert alert-success notification-message mt-4' role='alert'>\n\t\t\t\t\t\t<p className='m-0'>{PAGES.EMAIL_AUTH.MESSAGES.SUCCESSFULLY_AUTHORIZED}</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t) : error ? (\n\t\t\t<div className='row email-auth'>\n\t\t\t\t<div className='col-md-5 col-sm-12 mx-auto'>\n\t\t\t\t\t<img\n\t\t\t\t\t\tclassName='w-50 mx-auto d-block mt-5'\n\t\t\t\t\t\tsrc={PeerformanceLogo}\n\t\t\t\t\t\talt='Peerformance Logo'\n\t\t\t\t\t\twidth='263'\n\t\t\t\t\t\theight='121'\n\t\t\t\t\t/>\n\t\t\t\t\t<br/>\n\t\t\t\t\t<div className='alert alert-warning notification-message mt-4' role='alert'>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t{error}.\n\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\tIf you would like to renew the authorization process,\n\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\tclick on this link{' '}\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclassName='text-decoration-underline text-primary c-pointer'\n\t\t\t\t\t\t\t\tonClick={handleRefreshAuthToken}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tlink\n\t\t\t\t\t\t\t</span>{' '}\n\t\t\t\t\t\t\tand check your e-mail address to complete the authorization process.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t) : (\n\t\t\t\t<div className='row email-auth'>\n\t\t\t\t\t<div className='col-md-5 col-sm-12 mx-auto'>\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tclassName='w-50 mx-auto d-block mt-5'\n\t\t\t\t\t\t\tsrc={PeerformanceLogo}\n\t\t\t\t\t\t\talt='Peerformance Logo'\n\t\t\t\t\t\t\twidth='263'\n\t\t\t\t\t\t\theight='121'\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<Notification type='danger' message='Invalid token' />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t)\n\t) : null;\n};\n\nexport default EmailAuth;\n"]},"metadata":{},"sourceType":"module"}